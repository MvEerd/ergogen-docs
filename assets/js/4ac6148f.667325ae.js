"use strict";(self.webpackChunkergogen_docs=self.webpackChunkergogen_docs||[]).push([[789],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),m=a,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||i;return n?r.createElement(h,o(o({ref:t},c),{},{components:n})):r.createElement(h,o({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5146:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return c},default:function(){return d}});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),o=["components"],l={sidebar_position:2},s="Preprocessing",p={unversionedId:"preprocessing",id:"preprocessing",isDocsHomePage:!1,title:"Preprocessing",description:"Ergogen does a separate preprocessor pass on the config before starting to interpret it.",source:"@site/docs/preprocessing.md",sourceDirName:".",slug:"/preprocessing",permalink:"/ergogen-docs/preprocessing",editUrl:"https://github.com/mveerd/ergogen-docs/edit/main/website/docs/preprocessing.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Config overview",permalink:"/ergogen-docs/config-overview"},next:{title:"Units",permalink:"/ergogen-docs/units"}},c=[],u={toc:c};function d(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"preprocessing"},"Preprocessing"),(0,i.kt)("p",null,"Ergogen does a separate preprocessor pass on the config before starting to interpret it.\nThis consists of the following steps:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Unnesting"),": any object key containing dots (as in, ",(0,i.kt)("inlineCode",{parentName:"li"},"."),'s) will be unnested. This allows the use of the so called "dot notation". For example, ',(0,i.kt)("inlineCode",{parentName:"li"},"nested.key.definition: value")," will turn into ",(0,i.kt)("inlineCode",{parentName:"li"},"{nested: {key: {definition: value}}}")," in the preprocessed config object.")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Inheritance"),": the ",(0,i.kt)("inlineCode",{parentName:"p"},"$extends")," key can be used in any declaration to inherit values from another declaration. Extension happens according to the following rules:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"if the new value is ",(0,i.kt)("inlineCode",{parentName:"li"},"undefined"),", the old value will be used as a default;"),(0,i.kt)("li",{parentName:"ul"},"if both values are defined (and have the same type), the new one will override the old;"),(0,i.kt)("li",{parentName:"ul"},"if both values have different types, the new value will take precedence;"),(0,i.kt)("li",{parentName:"ul"},"if the new value is ",(0,i.kt)("inlineCode",{parentName:"li"},"$unset"),", the resulting value will be ",(0,i.kt)("inlineCode",{parentName:"li"},"undefined"),", regardless of previous type;"),(0,i.kt)("li",{parentName:"ul"},"for arrays or objects, extension is called for each child element recursively.")),(0,i.kt)("p",{parentName:"li"},"The actual value of the ",(0,i.kt)("inlineCode",{parentName:"p"},"$extends"),' key should be the full absolute path of the declaration we wish to inherit from (using the above mentioned, nested "dot notation" if necessary). For example:'),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"top:\n    parent:\n        a: 1\n        b: 2\nchild:\n    $extends: top.parent\n    c: 3\n")),(0,i.kt)("p",{parentName:"li"},"This declaration will lead to ",(0,i.kt)("inlineCode",{parentName:"p"},"child")," containing all three letter keys: ",(0,i.kt)("inlineCode",{parentName:"p"},"{a: 1, b: 2, c: 3}"),"."))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Parameterization"),": allows regex replacements within declarations. Take the following declaration as a starting point:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"top:\n    value: placeholder\n    double_value: placeholder * 2\n    $params: [placeholder]\n    $args: [3]\n")),(0,i.kt)("p",{parentName:"li"},'In this case, every occurrence of the value "placeholder" will be replaced with "3", which allows us to define it only once and still use it in multiple places (kind of like a pseudo-variable).'))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Skipping"),": the ",(0,i.kt)("inlineCode",{parentName:"p"},"$skip"),' key can be used anywhere to, well, skip (or "comment out" entire declarations). It can also be useful when combining inheritance and parameterization. For example:'),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"grandparent:\n    a: placeholder1\n    b: placeholder2\n    $params: [placeholder1, placeholder2]\nparent:\n    $extends: grandparent\n    $args: [value1]\nchild:\n    $extends: parent\n    $args: [,value2]\n")),(0,i.kt)("p",{parentName:"li"},"Here, the grandparent defines two different parameters, but only the child knows both arguments that should be substituted. This would lead to an error at the parent's level, because it has two parameters, and only one argument. But, assuming that this is just an intermediary abstract declaration and we wouldn't want to use it anyway, we can just declare ",(0,i.kt)("inlineCode",{parentName:"p"},"$skip: true"),"."))),(0,i.kt)("p",null,"The result of the preprocessor is ",(0,i.kt)("em",{parentName:"p"},"almost")," just a plain JSON object.\nThe only semantic difference is how numbers are handled. For example, the value ",(0,i.kt)("inlineCode",{parentName:"p"},"3 * 2")," would lead to a string type in JSON, but since it's a mathematical formula, it can also be interpreted as a number.\nErgogen tries this interpretation for every string value, and if it succeeds, it calculates the results and converts them to JSON numbers.\nThis syntax also works with variables, which we can use to define units (see below)."),(0,i.kt)("p",null,"Otherwise, we can begin with the actual keyboard-related layout..."))}d.isMDXComponent=!0}}]);